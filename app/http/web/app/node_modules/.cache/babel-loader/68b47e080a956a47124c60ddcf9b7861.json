{"ast":null,"code":"//    abc_crescendo_element.js: Definition of the CrescendoElem class.\n//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen\n//\n//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated\n//    documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation\n//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and\n//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n//\n//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n//\n//    THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING\n//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\nvar sprintf = require('./sprintf');\n\nvar CrescendoElem = function CrescendoElem(anchor1, anchor2, dir, positioning) {\n  this.anchor1 = anchor1; // must have a .x and a .parent property or be null (means starts at the \"beginning\" of the line - after keysig)\n\n  this.anchor2 = anchor2; // must have a .x property or be null (means ends at the end of the line)\n\n  this.dir = dir; // either \"<\" or \">\"\n\n  if (positioning === 'above') this.dynamicHeightAbove = 4;else this.dynamicHeightBelow = 4;\n  this.pitch = undefined; // This will be set later\n};\n\nCrescendoElem.prototype.setUpperAndLowerElements = function (positionY) {\n  if (this.dynamicHeightAbove) this.pitch = positionY.dynamicHeightAbove;else this.pitch = positionY.dynamicHeightBelow;\n};\n\nCrescendoElem.prototype.draw = function (renderer) {\n  if (this.pitch === undefined) window.console.error(\"Crescendo Element y-coordinate not set.\");\n  var y = renderer.calcY(this.pitch) + 4; // This is the top pixel to use (it is offset a little so that it looks good with the volume marks.)\n\n  var height = 8;\n\n  if (this.dir === \"<\") {\n    this.drawLine(renderer, y + height / 2, y);\n    this.drawLine(renderer, y + height / 2, y + height);\n  } else {\n    this.drawLine(renderer, y, y + height / 2);\n    this.drawLine(renderer, y + height, y + height / 2);\n  }\n};\n\nCrescendoElem.prototype.drawLine = function (renderer, y1, y2) {\n  // TODO-PER: This is just a quick hack to make the dynamic marks not crash if they are mismatched. See the slur treatment for the way to get the beginning and end.\n  var left = this.anchor1 ? this.anchor1.x : 0;\n  var right = this.anchor2 ? this.anchor2.x : 800;\n  var pathString = sprintf(\"M %f %f L %f %f\", left, y1, right, y2);\n  renderer.printPath({\n    path: pathString,\n    stroke: \"#000000\",\n    'class': renderer.addClasses('decoration')\n  });\n};\n\nmodule.exports = CrescendoElem;","map":{"version":3,"sources":["/Users/philbrockman/coding/MusicalGens/app/http/web/app/node_modules/abcjs/src/write/abc_crescendo_element.js"],"names":["sprintf","require","CrescendoElem","anchor1","anchor2","dir","positioning","dynamicHeightAbove","dynamicHeightBelow","pitch","undefined","prototype","setUpperAndLowerElements","positionY","draw","renderer","window","console","error","y","calcY","height","drawLine","y1","y2","left","x","right","pathString","printPath","path","stroke","addClasses","module","exports"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,IAAIA,OAAO,GAAGC,OAAO,CAAC,WAAD,CAArB;;AAEA,IAAIC,aAAa,GAAG,SAASA,aAAT,CAAuBC,OAAvB,EAAgCC,OAAhC,EAAyCC,GAAzC,EAA8CC,WAA9C,EAA2D;AAC9E,OAAKH,OAAL,GAAeA,OAAf,CAD8E,CACtD;;AACxB,OAAKC,OAAL,GAAeA,OAAf,CAF8E,CAEtD;;AACxB,OAAKC,GAAL,GAAWA,GAAX,CAH8E,CAG9D;;AAChB,MAAIC,WAAW,KAAK,OAApB,EACC,KAAKC,kBAAL,GAA0B,CAA1B,CADD,KAGC,KAAKC,kBAAL,GAA0B,CAA1B;AACD,OAAKC,KAAL,GAAaC,SAAb,CAR8E,CAQtD;AACxB,CATD;;AAWAR,aAAa,CAACS,SAAd,CAAwBC,wBAAxB,GAAmD,UAASC,SAAT,EAAoB;AACtE,MAAI,KAAKN,kBAAT,EACC,KAAKE,KAAL,GAAaI,SAAS,CAACN,kBAAvB,CADD,KAGC,KAAKE,KAAL,GAAaI,SAAS,CAACL,kBAAvB;AACD,CALD;;AAOAN,aAAa,CAACS,SAAd,CAAwBG,IAAxB,GAA+B,UAAUC,QAAV,EAAoB;AAClD,MAAI,KAAKN,KAAL,KAAeC,SAAnB,EACCM,MAAM,CAACC,OAAP,CAAeC,KAAf,CAAqB,yCAArB;AACD,MAAIC,CAAC,GAAGJ,QAAQ,CAACK,KAAT,CAAe,KAAKX,KAApB,IAA6B,CAArC,CAHkD,CAGV;;AACxC,MAAIY,MAAM,GAAG,CAAb;;AACA,MAAI,KAAKhB,GAAL,KAAa,GAAjB,EAAsB;AACrB,SAAKiB,QAAL,CAAcP,QAAd,EAAwBI,CAAC,GAACE,MAAM,GAAC,CAAjC,EAAoCF,CAApC;AACA,SAAKG,QAAL,CAAcP,QAAd,EAAwBI,CAAC,GAACE,MAAM,GAAC,CAAjC,EAAoCF,CAAC,GAACE,MAAtC;AACA,GAHD,MAGO;AACN,SAAKC,QAAL,CAAcP,QAAd,EAAwBI,CAAxB,EAA2BA,CAAC,GAACE,MAAM,GAAC,CAApC;AACA,SAAKC,QAAL,CAAcP,QAAd,EAAwBI,CAAC,GAACE,MAA1B,EAAkCF,CAAC,GAACE,MAAM,GAAC,CAA3C;AACA;AACD,CAZD;;AAcAnB,aAAa,CAACS,SAAd,CAAwBW,QAAxB,GAAmC,UAAUP,QAAV,EAAoBQ,EAApB,EAAwBC,EAAxB,EAA4B;AAC9D;AACA,MAAIC,IAAI,GAAG,KAAKtB,OAAL,GAAe,KAAKA,OAAL,CAAauB,CAA5B,GAAgC,CAA3C;AACA,MAAIC,KAAK,GAAG,KAAKvB,OAAL,GAAe,KAAKA,OAAL,CAAasB,CAA5B,GAAgC,GAA5C;AACA,MAAIE,UAAU,GAAG5B,OAAO,CAAC,iBAAD,EACvByB,IADuB,EACjBF,EADiB,EACbI,KADa,EACNH,EADM,CAAxB;AAEAT,EAAAA,QAAQ,CAACc,SAAT,CAAmB;AAACC,IAAAA,IAAI,EAACF,UAAN;AAAkBG,IAAAA,MAAM,EAAC,SAAzB;AAAoC,aAAShB,QAAQ,CAACiB,UAAT,CAAoB,YAApB;AAA7C,GAAnB;AACA,CAPD;;AASAC,MAAM,CAACC,OAAP,GAAiBhC,aAAjB","sourcesContent":["//    abc_crescendo_element.js: Definition of the CrescendoElem class.\n//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen\n//\n//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated\n//    documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation\n//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and\n//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n//\n//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n//\n//    THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING\n//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar sprintf = require('./sprintf');\n\nvar CrescendoElem = function CrescendoElem(anchor1, anchor2, dir, positioning) {\n\tthis.anchor1 = anchor1; // must have a .x and a .parent property or be null (means starts at the \"beginning\" of the line - after keysig)\n\tthis.anchor2 = anchor2; // must have a .x property or be null (means ends at the end of the line)\n\tthis.dir = dir; // either \"<\" or \">\"\n\tif (positioning === 'above')\n\t\tthis.dynamicHeightAbove = 4;\n\telse\n\t\tthis.dynamicHeightBelow = 4;\n\tthis.pitch = undefined; // This will be set later\n};\n\nCrescendoElem.prototype.setUpperAndLowerElements = function(positionY) {\n\tif (this.dynamicHeightAbove)\n\t\tthis.pitch = positionY.dynamicHeightAbove;\n\telse\n\t\tthis.pitch = positionY.dynamicHeightBelow;\n};\n\nCrescendoElem.prototype.draw = function (renderer) {\n\tif (this.pitch === undefined)\n\t\twindow.console.error(\"Crescendo Element y-coordinate not set.\");\n\tvar y = renderer.calcY(this.pitch) + 4; // This is the top pixel to use (it is offset a little so that it looks good with the volume marks.)\n\tvar height = 8;\n\tif (this.dir === \"<\") {\n\t\tthis.drawLine(renderer, y+height/2, y);\n\t\tthis.drawLine(renderer, y+height/2, y+height);\n\t} else {\n\t\tthis.drawLine(renderer, y, y+height/2);\n\t\tthis.drawLine(renderer, y+height, y+height/2);\n\t}\n};\n\nCrescendoElem.prototype.drawLine = function (renderer, y1, y2) {\n\t// TODO-PER: This is just a quick hack to make the dynamic marks not crash if they are mismatched. See the slur treatment for the way to get the beginning and end.\n\tvar left = this.anchor1 ? this.anchor1.x : 0;\n\tvar right = this.anchor2 ? this.anchor2.x : 800;\n\tvar pathString = sprintf(\"M %f %f L %f %f\",\n\t\tleft, y1, right, y2);\n\trenderer.printPath({path:pathString, stroke:\"#000000\", 'class': renderer.addClasses('decoration')});\n};\n\nmodule.exports = CrescendoElem;\n"]},"metadata":{},"sourceType":"script"}